<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="zh"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>App.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">gremlins</a> &gt; <a href="index.source.html" class="el_package">gremlins</a> &gt; <span class="el_source">App.java</span></div><h1>App.java</h1><pre class="source lang-java linenums">package gremlins;

import java.util.*;
import java.io.*;
import java.util.concurrent.CopyOnWriteArrayList;

import processing.core.PApplet;
import processing.core.PImage;
import processing.data.JSONObject;
import processing.event.KeyEvent;


/**
 * @author hzz
 */
public class App extends PApplet {

    public static final int WIDTH = 720;
    public static final int HEIGHT = 720;
    public static final int SPRITESIZE = 20;

    // public static final int BOTTOMBAR_HEIGHT = 60;


    public static final int FPS = 60;

<span class="fc" id="L27">    public static final Random RANDOM_GENERATOR = new Random();</span>

<span class="fc" id="L29">    public int x = 0;</span>
<span class="fc" id="L30">    public int y = 0;</span>
    public String configPath;
<span class="fc" id="L32">    public String layOutName = &quot;&quot;;</span>

    public PImage exitImage;
    public PImage brickWallImage;
    public PImage stoneWallImage;

    public PImage gremlinImage;
    public PImage wizardLeftImage;
    public PImage wizardRightImage;
    public PImage wizardUpImage;
    public PImage wizardDownImage;
    public PImage slimeImage;
    public PImage fireballImage;
    public PImage powerupImage;
    public PImage eliteEnemyImage;
    public PImage transportDoorImage;
    public PImage[] brickWallDestroyImages;

    public float wizardCooldown;
    public float enemyCooldown;
    public int wizardLife;

<span class="fc" id="L54">    public static final String ROOT_PATH = System.getProperty(&quot;user.dir&quot;);</span>
    public int level;
    public int totalLevels;
    public JSONObject conf;

    public static final int MAP_WIDTH_TILES = 33;
    public static final int MAP_HEIGHT_TILES = 36;
    public boolean gameStarted;
    public boolean gameOver;
    public boolean gameWon;

    protected AbstractObject[][] map;

    public Wizard player;
    public CopyOnWriteArrayList&lt;Gremlin&gt; gremlins;
    public CopyOnWriteArrayList&lt;Fireball&gt; fireballs;

    public int wizardAttackTimer;
    public int levelInitTimer;
    public int wizardCoolDownTimer;
    public boolean wizardCooling;
    public Exit exit;
    public List&lt;Powerup&gt; powerups;

    public List&lt;Slime&gt; slimes;
    public List&lt;BrickWallDestruction&gt; brickWallDestructions;
    public List&lt;TransportDoor&gt; transportDoors;
    public List&lt;int[]&gt; emptyTiles;
    public int powerUpSpawnTime;
    public int gameStopTimer;
    public int restartTimer;

<span class="fc" id="L86">    public App() {</span>
        //construct objects here
<span class="fc" id="L88">        this.x = 0;</span>
<span class="fc" id="L89">        this.y = 0;</span>
<span class="fc" id="L90">        this.configPath = &quot;config.json&quot;;</span>
<span class="fc" id="L91">        this.conf = loadJSONObject(new File(this.configPath));</span>
<span class="fc" id="L92">        this.level = 1;</span>
<span class="fc" id="L93">        this.totalLevels = this.conf.getJSONArray(&quot;levels&quot;).size();</span>
<span class="fc" id="L94">        this.map = new AbstractObject[App.MAP_WIDTH_TILES][App.MAP_HEIGHT_TILES];</span>
<span class="fc" id="L95">        this.wizardLife = this.conf.getInt(&quot;lives&quot;);</span>
<span class="fc" id="L96">        this.player = null;</span>
<span class="fc" id="L97">        this.exit = null;</span>
<span class="fc" id="L98">        this.gremlins = new CopyOnWriteArrayList&lt;&gt;();</span>
<span class="fc" id="L99">        this.slimes = new CopyOnWriteArrayList&lt;&gt;();</span>
<span class="fc" id="L100">        this.fireballs = new CopyOnWriteArrayList&lt;&gt;();</span>
<span class="fc" id="L101">        this.brickWallDestroyImages = new PImage[4];</span>
<span class="fc" id="L102">        this.powerups = new CopyOnWriteArrayList&lt;&gt;();</span>
<span class="fc" id="L103">        this.brickWallDestructions = new CopyOnWriteArrayList&lt;&gt;();</span>
<span class="fc" id="L104">        this.transportDoors = new CopyOnWriteArrayList&lt;&gt;();</span>
<span class="fc" id="L105">        this.emptyTiles = new CopyOnWriteArrayList&lt;&gt;();</span>
<span class="fc" id="L106">        this.powerUpSpawnTime = 8;</span>
<span class="fc" id="L107">        this.gameStarted = false;</span>
<span class="fc" id="L108">        this.gameOver = false;</span>
<span class="fc" id="L109">        this.gameWon = false;</span>
<span class="fc" id="L110">    }</span>


    /**
     * Initialise the setting of the window size.
     */
    @Override
    public void settings() {
<span class="fc" id="L118">        size(App.WIDTH, App.HEIGHT);</span>
<span class="fc" id="L119">    }</span>

    /**
     * Load all resources such as images. Initialise the elements such as the player, enemies and map
     * elements.
     */
    @Override
    public void setup() {

<span class="fc" id="L128">        textSize(18);</span>
<span class="fc" id="L129">        frameRate(App.FPS);</span>
<span class="fc" id="L130">        smooth();</span>
<span class="fc" id="L131">        surface.setTitle(&quot;Gremlins&quot;);</span>
<span class="fc" id="L132">        surface.setResizable(false);</span>

        // Load images during setup
<span class="fc" id="L135">        this.exitImage = loadImage(Objects.requireNonNull(this.getClass().getResource(&quot;exit.png&quot;)).getPath());</span>
<span class="fc" id="L136">        this.brickWallImage = loadImage(Objects.requireNonNull(this.getClass().getResource(&quot;brickwall.png&quot;)).getPath());</span>
<span class="fc" id="L137">        this.stoneWallImage = loadImage(Objects.requireNonNull(this.getClass().getResource(&quot;stonewall.png&quot;)).getPath());</span>
<span class="fc" id="L138">        this.gremlinImage = loadImage(Objects.requireNonNull(this.getClass().getResource(&quot;gremlin.png&quot;)).getPath());</span>
<span class="fc" id="L139">        this.wizardLeftImage = loadImage(Objects.requireNonNull(this.getClass().getResource(&quot;wizard0.png&quot;)).getPath());</span>
<span class="fc" id="L140">        this.wizardRightImage = loadImage(Objects.requireNonNull(this.getClass().getResource(&quot;wizard1.png&quot;)).getPath());</span>
<span class="fc" id="L141">        this.wizardUpImage = loadImage(Objects.requireNonNull(this.getClass().getResource(&quot;wizard2.png&quot;)).getPath());</span>
<span class="fc" id="L142">        this.wizardDownImage = loadImage(Objects.requireNonNull(this.getClass().getResource(&quot;wizard3.png&quot;)).getPath());</span>
<span class="fc" id="L143">        this.slimeImage = loadImage(Objects.requireNonNull(this.getClass().getResource(&quot;slime.png&quot;)).getPath());</span>
<span class="fc" id="L144">        this.fireballImage = loadImage(Objects.requireNonNull(this.getClass().getResource(&quot;fireball.png&quot;)).getPath());</span>
<span class="fc" id="L145">        this.powerupImage = loadImage(Objects.requireNonNull(this.getClass().getResource(&quot;powerup.png&quot;)).getPath());</span>
<span class="fc" id="L146">        this.brickWallDestroyImages[0] = loadImage(Objects.requireNonNull(this.getClass().getResource(&quot;brickwall_destroyed0.png&quot;)).getPath());</span>
<span class="fc" id="L147">        this.brickWallDestroyImages[1] = loadImage(Objects.requireNonNull(this.getClass().getResource(&quot;brickwall_destroyed1.png&quot;)).getPath());</span>
<span class="fc" id="L148">        this.brickWallDestroyImages[2] = loadImage(Objects.requireNonNull(this.getClass().getResource(&quot;brickwall_destroyed2.png&quot;)).getPath());</span>
<span class="fc" id="L149">        this.brickWallDestroyImages[3] = loadImage(Objects.requireNonNull(this.getClass().getResource(&quot;brickwall_destroyed3.png&quot;)).getPath());</span>
<span class="fc" id="L150">        this.eliteEnemyImage = loadImage(Objects.requireNonNull(this.getClass().getResource(&quot;eliteEnemy.png&quot;)).getPath());</span>
<span class="fc" id="L151">        this.transportDoorImage = loadImage(Objects.requireNonNull(this.getClass().getResource(&quot;transportDoor.png&quot;)).getPath());</span>

<span class="fc" id="L153">        this.loadMap();</span>

<span class="fc" id="L155">    }</span>

    static final int LEFT = 37;
    static final int RIGHT = 39;
    static final int UP = 38;
    static final int DOWN = 40;
    static final int SPACE = 32;

    /**
     * Receive key pressed signal from the keyboard.
     */
    @Override
    public void keyPressed(KeyEvent e) {
<span class="nc" id="L168">        int keyCode = e.getKeyCode();</span>
<span class="nc bnc" id="L169" title="All 2 branches missed.">        if (this.gameStarted) {</span>
<span class="nc bnc" id="L170" title="All 4 branches missed.">            if (!this.gameWon &amp;&amp; !this.gameOver) {</span>
<span class="nc bnc" id="L171" title="All 6 branches missed.">                switch (keyCode) {</span>
                    case App.LEFT:
<span class="nc" id="L173">                        this.player.wizardMove(this, &quot;left&quot;);</span>
<span class="nc" id="L174">                        break;</span>
                    case App.UP:
<span class="nc" id="L176">                        this.player.wizardMove(this, &quot;up&quot;);</span>
<span class="nc" id="L177">                        break;</span>
                    case App.RIGHT:
<span class="nc" id="L179">                        this.player.wizardMove(this, &quot;right&quot;);</span>
<span class="nc" id="L180">                        break;</span>
                    case App.DOWN:
<span class="nc" id="L182">                        this.player.wizardMove(this, &quot;down&quot;);</span>
<span class="nc" id="L183">                        break;</span>
                    case App.SPACE:
<span class="nc" id="L185">                        this.player.wizardAttack(this);</span>
<span class="nc" id="L186">                        break;</span>
                    default:
<span class="nc" id="L188">                        break;</span>
                }
            } else {
<span class="nc bnc" id="L191" title="All 2 branches missed.">                if (keyCode &gt;= 0) {</span>
<span class="nc" id="L192">                    this.restartTimer = millis();</span>
<span class="nc bnc" id="L193" title="All 2 branches missed.">                    if (this.restartTimer - this.gameStopTimer &gt;= 1000) {</span>
<span class="nc" id="L194">                        this.restart();</span>
                    } else {
<span class="nc" id="L196">                        text(&quot;Please wait 1 second.&quot;, 250, 600);</span>
                    }
                }
            }
        } else {
<span class="nc bnc" id="L201" title="All 2 branches missed.">            if (keyCode &gt;= 0) {</span>
<span class="nc" id="L202">                this.gameStarted = true;</span>
<span class="nc" id="L203">                this.levelInitTimer = millis();</span>
            }
        }
<span class="nc" id="L206">    }</span>


    /**
     * Receive key released signal from the keyboard.
     */

    @Override
    public void keyReleased() {
<span class="nc" id="L215">        this.player.wizardStop();</span>
<span class="nc" id="L216">    }</span>


    /**
     * Draw all elements in the game by current frame.
     */

    @Override
    public void draw() {
        //Main loop here, execute per frame.
<span class="fc" id="L226">        background(197, 151, 113);</span>

<span class="pc bpc" id="L228" title="1 of 2 branches missed.">        if (!this.gameStarted) {</span>

<span class="nc" id="L230">            this.displayWelcome();</span>

        } else {

<span class="fc" id="L234">            this.displayMap();</span>

<span class="fc" id="L236">            this.updateEmptyTiles();</span>

            //Display lives
<span class="fc" id="L239">            this.displayLife();</span>

            //Display level information
<span class="fc" id="L242">            this.displayLevels();</span>

            // Display wizard each frame
<span class="fc" id="L245">            this.displayPlayer();</span>

<span class="fc" id="L247">            this.displayFireBalls();</span>

            //Display gremlins each frame
<span class="fc" id="L250">            this.displayGremlins();</span>

<span class="fc" id="L252">            this.displaySlimes();</span>

<span class="fc" id="L254">            this.displayExit();</span>

<span class="fc" id="L256">            this.displayTransportDoors();</span>

<span class="fc" id="L258">            this.displayDestructions();</span>

<span class="fc" id="L260">            this.displayPowerups();</span>

<span class="fc" id="L262">            this.displayWinOrLose();</span>
        }
<span class="fc" id="L264">    }</span>

    private void displayWelcome() {
<span class="nc" id="L267">        fill(255);</span>
<span class="nc" id="L268">        text(&quot;Welcome!&quot;, 300, 300);</span>
<span class="nc" id="L269">        text(&quot;USYD COMP-9003 Project.&quot;, 230, 350);</span>
<span class="nc" id="L270">        fill(30, 130, 60);</span>
<span class="nc" id="L271">        text(&quot;Press any key to start.&quot;, 250, 400);</span>
<span class="nc" id="L272">    }</span>


    public boolean validMap() {
        // Load map from config file
<span class="fc" id="L277">        this.layOutName = this.conf.getJSONArray(&quot;levels&quot;).getJSONObject(this.level - 1).getString(&quot;layout&quot;);</span>
<span class="fc" id="L278">        File layOutFile = new File(App.ROOT_PATH + &quot;/&quot; + this.layOutName);</span>

<span class="fc" id="L280">        int exitNum = 0;</span>
<span class="fc" id="L281">        int gremlinNum = 0;</span>
<span class="fc" id="L282">        int startNum = 0;</span>
<span class="fc" id="L283">        int column = 0;</span>
<span class="fc" id="L284">        int row = 0;</span>

<span class="fc" id="L286">        boolean numberRequire = true;</span>
<span class="fc" id="L287">        boolean columnRequire = true;</span>
<span class="fc" id="L288">        boolean rowRequire = true;</span>
<span class="fc" id="L289">        boolean legalRequire = true;</span>
<span class="fc" id="L290">        boolean warpRequire = true;</span>

<span class="fc" id="L292">        try (Scanner validScanner = new Scanner(layOutFile)) {</span>
            char[] line;

<span class="fc bfc" id="L295" title="All 2 branches covered.">            while (validScanner.hasNextLine()) {</span>

<span class="fc" id="L297">                line = validScanner.nextLine().toCharArray();</span>
<span class="fc" id="L298">                row++;</span>

<span class="fc bfc" id="L300" title="All 2 branches covered.">                for (char c : line) {</span>
<span class="fc" id="L301">                    column++;</span>

<span class="fc bfc" id="L303" title="All 8 branches covered.">                    if (column == 1 || column == 36 || row == 1 || row == 33) {</span>
<span class="pc bpc" id="L304" title="1 of 2 branches missed.">                        if (c != 'X') {</span>
<span class="nc" id="L305">                            warpRequire = false;</span>
                        }
                    }

<span class="pc bpc" id="L309" title="1 of 18 branches missed.">                    if (c != 'X' &amp;&amp; c != 'B' &amp;&amp; c != ' ' &amp;&amp; c != 'G' &amp;&amp; c != 'W' &amp;&amp; c != 'E' &amp;&amp; c != 'P' &amp;&amp; c != 'S' &amp;&amp; c != 'T') {</span>
<span class="nc" id="L310">                        legalRequire = false;</span>
                    }

<span class="fc bfc" id="L313" title="All 2 branches covered.">                    if (c == 'E') {</span>
<span class="fc" id="L314">                        exitNum++;</span>
<span class="fc bfc" id="L315" title="All 2 branches covered.">                    } else if (c == 'G') {</span>
<span class="fc" id="L316">                        gremlinNum++;</span>
<span class="fc bfc" id="L317" title="All 2 branches covered.">                    } else if (c == 'W') {</span>
<span class="fc" id="L318">                        startNum++;</span>
                    }

                }

<span class="pc bpc" id="L323" title="1 of 2 branches missed.">                if (column != 36) {</span>
<span class="nc" id="L324">                    columnRequire = false;</span>
                }

<span class="fc" id="L327">                column = 0;</span>

            }

<span class="pc bpc" id="L331" title="1 of 2 branches missed.">            if (row != 33) {</span>
<span class="nc" id="L332">                rowRequire = false;</span>
            }

<span class="pc bpc" id="L335" title="3 of 6 branches missed.">            numberRequire = exitNum &gt;= 1 &amp;&amp; gremlinNum &gt;= 1 &amp;&amp; startNum == 1;</span>

<span class="pc bpc" id="L337" title="5 of 10 branches missed.">            return legalRequire &amp;&amp; numberRequire &amp;&amp; columnRequire &amp;&amp; rowRequire &amp;&amp; warpRequire;</span>


<span class="nc" id="L340">        } catch (IOException e) {</span>
<span class="nc" id="L341">            e.printStackTrace();</span>
<span class="nc" id="L342">            return false;</span>
        }
    }


    public void initMap() {
        // Load map from config file
<span class="fc" id="L349">        this.wizardCooldown = this.conf.getJSONArray(&quot;levels&quot;).getJSONObject(this.level - 1).getFloat(&quot;wizard_cooldown&quot;);</span>
<span class="fc" id="L350">        this.enemyCooldown = this.conf.getJSONArray(&quot;levels&quot;).getJSONObject(this.level - 1).getFloat(&quot;enemy_cooldown&quot;);</span>
<span class="fc" id="L351">        this.layOutName = this.conf.getJSONArray(&quot;levels&quot;).getJSONObject(this.level - 1).getString(&quot;layout&quot;);</span>
<span class="fc" id="L352">        File layOutFile = new File(App.ROOT_PATH + &quot;/&quot; + this.layOutName);</span>

<span class="fc" id="L354">        try (Scanner layOutScanner = new Scanner(layOutFile)) {</span>
<span class="fc" id="L355">            int i = 0;</span>
<span class="fc" id="L356">            int j = 0;</span>
            char[] line;

<span class="fc bfc" id="L359" title="All 2 branches covered.">            while (layOutScanner.hasNextLine()) {</span>
<span class="fc" id="L360">                line = layOutScanner.nextLine().toCharArray();</span>
<span class="fc bfc" id="L361" title="All 2 branches covered.">                for (char c : line) {</span>
                    AbstractObject tmp;
<span class="fc bfc" id="L363" title="All 9 branches covered.">                    switch (c) {</span>
                        case 'X':
<span class="fc" id="L365">                            tmp = new StoneWall(this, this.x, this.y);</span>
<span class="fc" id="L366">                            map[i][j] = tmp;</span>
<span class="fc" id="L367">                            break;</span>
                        case 'W':
<span class="fc" id="L369">                            this.player = new Wizard(this, this.x, this.y);</span>
<span class="fc" id="L370">                            map[i][j] = null;</span>
<span class="fc" id="L371">                            break;</span>
                        case 'B':
<span class="fc" id="L373">                            tmp = new BrickWall(this, this.x, this.y);</span>
<span class="fc" id="L374">                            map[i][j] = tmp;</span>
<span class="fc" id="L375">                            break;</span>
                        case 'E':
<span class="fc" id="L377">                            this.exit = new Exit(this, this.x, this.y);</span>
<span class="fc" id="L378">                            map[i][j] = null;</span>
<span class="fc" id="L379">                            break;</span>
                        case 'G':
<span class="fc" id="L381">                            this.gremlins.add(new Gremlin(this, this.x, this.y));</span>
<span class="fc" id="L382">                            map[i][j] = null;</span>
<span class="fc" id="L383">                            break;</span>
                        case 'P':
<span class="fc" id="L385">                            this.powerups.add(new Powerup(this, this.x, this.y));</span>
<span class="fc" id="L386">                            map[i][j] = null;</span>
<span class="fc" id="L387">                            break;</span>
                        case 'S':
<span class="fc" id="L389">                            this.gremlins.add(new EliteEnemy(this, this.x, this.y));</span>
<span class="fc" id="L390">                            map[i][j] = null;</span>
<span class="fc" id="L391">                            break;</span>
                        case 'T':
<span class="fc" id="L393">                            this.transportDoors.add(new TransportDoor(this, this.x, this.y));</span>
<span class="fc" id="L394">                            map[i][j] = null;</span>
<span class="fc" id="L395">                            break;</span>
                        case ' ':
                        default:
<span class="fc" id="L398">                            map[i][j] = null;</span>
                            break;
                    }

<span class="fc" id="L402">                    this.x += SPRITESIZE;</span>
<span class="fc" id="L403">                    j++;</span>
                }
                // reset x to 0 after each line
<span class="fc" id="L406">                this.x = 0;</span>
<span class="fc" id="L407">                this.y += SPRITESIZE;</span>
<span class="fc" id="L408">                j = 0;</span>
<span class="fc" id="L409">                i++;</span>
            }
            //reset x and y after map generation
<span class="fc" id="L412">            this.x = 0;</span>
<span class="fc" id="L413">            this.y = 0;</span>
<span class="fc" id="L414">            this.levelInitTimer = millis();</span>
<span class="nc" id="L415">        } catch (IOException e) {</span>
<span class="nc" id="L416">            System.out.println(&quot;Config file not found&quot;);</span>
<span class="nc" id="L417">            throw new RuntimeException(e);</span>
<span class="fc" id="L418">        }</span>
<span class="fc" id="L419">    }</span>


    public void loadMap() {
<span class="pc bpc" id="L423" title="1 of 2 branches missed.">        if (validMap()) {</span>
            //Load map
<span class="fc" id="L425">            initMap();</span>
        } else {
<span class="nc" id="L427">            fill(255, 255, 255);</span>
<span class="nc" id="L428">            text(&quot;Invalid map&quot;, 350, 350);</span>
<span class="nc" id="L429">            stop();</span>
        }
<span class="fc" id="L431">    }</span>

    private void displayMap() {
<span class="fc bfc" id="L434" title="All 2 branches covered.">        for (int i = 0; i &lt; App.MAP_WIDTH_TILES; i++) {</span>
<span class="fc bfc" id="L435" title="All 2 branches covered.">            for (int j = 0; j &lt; App.MAP_HEIGHT_TILES; j++) {</span>
<span class="fc bfc" id="L436" title="All 2 branches covered.">                if (this.map[i][j] != null) {</span>
<span class="fc" id="L437">                    this.map[i][j].tick(this);</span>
                }
            }
        }
<span class="fc" id="L441">    }</span>


    public void displayLife() {
<span class="fc" id="L445">        fill(255, 255, 255);</span>
<span class="fc" id="L446">        text(&quot;Lives:&quot;, 10, 700);</span>
<span class="fc bfc" id="L447" title="All 2 branches covered.">        for (int i = 65, j = 0; j &lt; this.wizardLife; i += App.SPRITESIZE, j++) {</span>
<span class="fc" id="L448">            image(this.wizardRightImage, i, 685);</span>
        }
<span class="fc" id="L450">    }</span>

    public void displayFireBalls() {
<span class="pc bpc" id="L453" title="1 of 2 branches missed.">        for (Fireball fireBall : this.fireballs) {</span>
<span class="nc" id="L454">            fireBall.tick(this);</span>
<span class="nc" id="L455">        }</span>
<span class="fc" id="L456">    }</span>

    public void displayGremlins() {
<span class="fc bfc" id="L459" title="All 2 branches covered.">        for (Gremlin gremlin : this.gremlins) {</span>
<span class="fc" id="L460">            gremlin.tick(this);</span>
<span class="fc" id="L461">        }</span>
<span class="fc" id="L462">    }</span>

    public void displaySlimes() {
<span class="fc bfc" id="L465" title="All 2 branches covered.">        for (Slime slime : this.slimes) {</span>
<span class="fc" id="L466">            slime.tick(this);</span>
<span class="fc" id="L467">        }</span>
<span class="fc" id="L468">    }</span>

    public void displayPlayer() {
<span class="fc" id="L471">        this.player.tick(this);</span>
<span class="fc" id="L472">    }</span>

    public void displayExit() {
<span class="fc" id="L475">        this.exit.tick(this);</span>
<span class="fc" id="L476">    }</span>

    public void displayLevels() {
<span class="fc" id="L479">        fill(255, 255, 255);</span>
<span class="fc" id="L480">        text(&quot;Level&quot;, 200, 700);</span>
<span class="fc" id="L481">        text(this.level, 250, 700);</span>
<span class="fc" id="L482">        text('/', 265, 700);</span>
<span class="fc" id="L483">        text(this.totalLevels, 280, 700);</span>
<span class="fc" id="L484">    }</span>


    public void displayDestructions() {
<span class="pc bpc" id="L488" title="1 of 2 branches missed.">        for (BrickWallDestruction destruction : this.brickWallDestructions) {</span>
<span class="nc" id="L489">            destruction.tick(this);</span>
<span class="nc" id="L490">        }</span>
<span class="fc" id="L491">    }</span>

    public void displayTransportDoors() {
<span class="fc bfc" id="L494" title="All 2 branches covered.">        for (TransportDoor transportDoor : this.transportDoors) {</span>
<span class="fc" id="L495">            transportDoor.tick(this);</span>
<span class="fc" id="L496">        }</span>
<span class="fc" id="L497">    }</span>


    public int getMapX(AbstractObject object) {
<span class="nc" id="L501">        return object.getY() / App.SPRITESIZE;</span>
    }

    public int getMapY(AbstractObject object) {
<span class="nc" id="L505">        return object.getX() / App.SPRITESIZE;</span>
    }

    public int getImageX(int y) {
<span class="fc" id="L509">        return y * App.SPRITESIZE;</span>
    }

    public int getImageY(int x) {
<span class="fc" id="L513">        return x * App.SPRITESIZE;</span>
    }

    public void updateEmptyTiles() {
<span class="fc" id="L517">        this.emptyTiles.clear();</span>
<span class="fc bfc" id="L518" title="All 2 branches covered.">        for (int i = 0; i &lt; App.MAP_WIDTH_TILES; i++) {</span>
<span class="fc bfc" id="L519" title="All 2 branches covered.">            for (int j = 0; j &lt; App.MAP_HEIGHT_TILES; j++) {</span>
<span class="fc bfc" id="L520" title="All 2 branches covered.">                if (this.map[i][j] == null) {</span>
<span class="fc" id="L521">                    this.emptyTiles.add(new int[]{this.getImageX(j), this.getImageY(i)});</span>
                }
            }
        }
<span class="fc" id="L525">    }</span>


    public void displayPowerups() {
<span class="pc bpc" id="L529" title="1 of 2 branches missed.">        if (millis() - this.levelInitTimer &gt;= this.powerUpSpawnTime * 1000) {</span>
<span class="nc bnc" id="L530" title="All 2 branches missed.">            for (Powerup powerup : this.powerups) {</span>
<span class="nc" id="L531">                powerup.tick(this);</span>
<span class="nc" id="L532">            }</span>
        }
<span class="fc" id="L534">    }</span>


    public void resetLevel() {
<span class="nc" id="L538">        this.gremlins.clear();</span>
<span class="nc" id="L539">        this.slimes.clear();</span>
<span class="nc" id="L540">        this.fireballs.clear();</span>
<span class="nc" id="L541">        this.brickWallDestructions.clear();</span>
<span class="nc" id="L542">        this.powerups.clear();</span>
<span class="nc" id="L543">        this.transportDoors.clear();</span>
<span class="nc" id="L544">        this.loadMap();</span>
<span class="nc" id="L545">    }</span>


    public void displayWinOrLose() {
<span class="pc bpc" id="L549" title="1 of 2 branches missed.">        if (this.gameOver) {</span>
<span class="nc" id="L550">            background(197, 151, 113);</span>
<span class="nc" id="L551">            text(&quot;Game Over&quot;, 300, 300);</span>
<span class="nc" id="L552">            text(&quot;Press any key to restart&quot;, 250, 400);</span>
        }

<span class="pc bpc" id="L555" title="1 of 2 branches missed.">        if (this.gameWon) {</span>
<span class="nc" id="L556">            background(197, 151, 113);</span>
<span class="nc" id="L557">            text(&quot;You Win!&quot;, 300, 300);</span>
<span class="nc" id="L558">            text(&quot;Press any key to restart&quot;, 250, 400);</span>
        }
<span class="fc" id="L560">    }</span>

    private void restart() {
<span class="nc" id="L563">        this.level = 1;</span>
<span class="nc" id="L564">        this.wizardLife = this.conf.getInt(&quot;lives&quot;);</span>
<span class="nc" id="L565">        this.gremlins.clear();</span>
<span class="nc" id="L566">        this.slimes.clear();</span>
<span class="nc" id="L567">        this.fireballs.clear();</span>
<span class="nc" id="L568">        this.brickWallDestructions.clear();</span>
<span class="nc" id="L569">        this.powerups.clear();</span>
<span class="nc" id="L570">        this.transportDoors.clear();</span>
<span class="nc" id="L571">        this.loadMap();</span>
<span class="nc" id="L572">        this.gameOver = false;</span>
<span class="nc" id="L573">        this.gameWon = false;</span>
<span class="nc" id="L574">    }</span>


    public static void main(String[] args) {
<span class="nc" id="L578">        PApplet.main(&quot;gremlins.App&quot;);</span>
<span class="nc" id="L579">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span></div></body></html>